<md-content layout="row" md-colors="{background: 'grey-200'}" layout-align="center" class="body">
  <div flex-gt-lg="80" flex-lg="90" layout-align="center" layout-fill>
    <div flex layout="column">
      <md-card flex layout="column">
      <md-card-header>
        <md-card-avatar>
          <img ng-src="{{ eventCtrl.user.current_institution.photo_url }}" class="md-user-avatar"/>
        </md-card-avatar>
        <md-card-header-text>
          <span class="md-title">{{ eventCtrl.user.current_institution.name }}</span>
          <span class="md-subhead">por {{ eventCtrl.user.name }}</span>
        </md-card-header-text>
      </md-card-header>
      <div class="md-toolbar-tools" layout-align="center center"  ng-if="eventCtrl.showButton">
        <md-button ng-click="eventCtrl.showButton = false;">
          Criar novo evento
        </md-button>
      </div>
      <md-card-content layout="column" ng-if="!eventCtrl.showButton">
        <md-input-container>
          <label>Título</label>
          <input ng-model="eventCtrl.event.title" placeholder="Escreva aqui o nome do evento" required="true">
        </md-input-container>
        <md-input-container>
          <label>Descrição</label>
          <textarea style="max-height: 400px;overflow-y:auto;resize:none;" ng-model="eventCtrl.event.text" md-select-on-focus placeholder="Escreva aqui a descrição do evento"></textarea>
          </textarea>
        </md-input-container>
        <md-input-container>
          <label>Local</label>
          <input ng-model="eventCtrl.event.local" placeholder="Escreva aqui o local do evento" required="true">
        </md-input-container>
        <div layout="row">
          <md-input-container class="md-input-has-placeholder">
            <label>Início</label>
            <input mdc-datetime-picker="" date="true" time="true" type="text" format="DD-MM-YYYY HH:mm" lang="pt-BR"
            placeholder="Data/Horário" ng-model="eventCtrl.event.start_time" class=" md-input" today-text="Hoje"
            readonly="readonly" cancel-text="Cancelar">
            <div class="md-errors-spacer"></div>
          </md-input-container>
          <md-input-container class="md-input-has-placeholder">
            <label>Fim</label>
            <input mdc-datetime-picker="" date="true" time="true" type="text" lang="pt-BR" today-text="Hoje"
            placeholder="Data/Horário" class=" md-input" readonly="readonly" format="DD-MM-YYYY HH:mm"
            id="input_1" ng-model="eventCtrl.event.end_time" cancel-text="Cancelar">
            <div class="md-errors-spacer"></div>
          </md-input-container>
        </div>
        <div class="image-view" ng-if="eventCtrl.showImage()">
          <button ng-click="eventCtrl.cleanImage()">&times;</button>
          <img style="border-radius: 5%;" ng-src="{{ eventCtrl.photoUrl }}"/>
        </div>
        <md-progress-linear ng-show="eventCtrl.loading" md-mode="indeterminate" style="width: 14%; margin-top: 5px"></md-progress-linear>
      </md-card-content>
      <div layout="row">
        <span flex></span>
        <md-button class="md-icon-button" ng-click="eventCtrl.clear()" ng-if="!eventCtrl.showButton">
          <md-icon>cancel</md-icon>
        </md-button>
        <md-button class="md-icon-button" ng-click="null" ng-model="eventCtrl.file" ngf-pattern="'image/*'"
                      ngf-accept="'image/*'" ngf-max-size="5MB" ng-if="!eventCtrl.showButton"
                      ngf-select="eventCtrl.addImage(eventCtrl.file)">
              <md-icon>add_a_photo</md-icon>
        </md-button>
        <md-button class="md-icon-button" ng-click="eventCtrl.save()" ng-if="eventCtrl.showButtonSend()">
          <md-icon>send</md-icon>
        </md-button>
    </md-card>
    </div>

  </div>
  <md-card flex layout="column">
        <md-list class="md-dense" flex>
          <md-subheader class="md-no-sticky">Eventos</md-subheader>
            <md-list-item class="md-3-line"
                ng-repeat="event in eventCtrl.events | orderBy : eventCtrl.events.start_time" ng-click="null">
              <div class="image-view" ng-if="event.photo_url" layout="row">
                <img class="md-card-image" style="border-radius: 3%;" ng-src="{{ event.photo_url }}"/>
              </div>
              <div class="md-list-item-text" style="padding: 2%;">
                <label>{{ event.title }}</label>
                <h3>Horário</h3>
                <p>De {{ event.start_time | date: 'dd-MM-yyyy'}} às {{ event.start_time | date: 'HH:mm:ss'}} até 
                   {{ event.end_time | date: 'dd-MM-yyyy'}} às {{ event.end_time | date: 'HH:mm:ss'}}</p>
                <h3 ng-if="event.text">Descrição</h3>
                <p ng-if="event.text">{{ event.text }}</p>
                <h3>Local</h3>
                <p>{{ event.local }}</p>
                <h3>Autor/Instituição</h3>
                <p>{{ event.author_name }} por {{ event.institution_name}}</p>
              </div>
            </md-list-item>
        </md-list>
      </md-card>
</md-content>

